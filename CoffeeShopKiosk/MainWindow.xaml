<Window x:Class="CoffeeShopKiosk.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:views="clr-namespace:CoffeeShopKiosk.Views"
    xmlns:app="clr-namespace:CoffeeShopKiosk"
    Title="Coffee Shop Kiosk" WindowState="Maximized" WindowStyle="SingleBorderWindow" ResizeMode="CanResize"
    KeyDown="Window_KeyDown">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="100"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="360" />
        </Grid.ColumnDefinitions>

        <!-- subtle cafe gradient -->
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#FFF9F5" Offset="0" />
                <GradientStop Color="#F1E6DE" Offset="1" />
            </LinearGradientBrush>
        </Grid.Background>

        <!-- Theme visuals overlay (e.g., rain drops) -->
        <views:ThemeVisualsControl x:Name="ThemeVisuals" Grid.RowSpan="2" Grid.ColumnSpan="2" IsHitTestVisible="False" />

        <!-- Coffee-themed header -->
        <Border Grid.Row="0" Grid.ColumnSpan="2" Background="{DynamicResource CoffeeBrown}" CornerRadius="0,0,32,32" Height="100" VerticalAlignment="Top" Effect="{DynamicResource DropShadowEffect}">
            <DockPanel LastChildFill="False">
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,24,0">
                    <!-- Header actions will be here (swapped earlier so right-docked content doesn't become the last-child fill) -->
                </StackPanel>

                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="30,0,0,0">
                    <!-- Bigger coffee cup mark -->
                    <Viewbox Height="58" Width="58" Margin="0,0,18,0">
                        <Canvas Width="48" Height="48">
                            <Path Data="M12,40 Q24,48 36,40 Q36,24 24,24 Q12,24 12,40 Z M24,24 Q24,12 36,12 Q36,24 24,24 Z" Fill="#FFF8F0" Stroke="#C7A17A" StrokeThickness="2"/>
                            <Ellipse Canvas.Left="18" Canvas.Top="8" Width="12" Height="8" Fill="#C7A17A" Opacity="0.7"/>
                        </Canvas>
                    </Viewbox>

                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Coffee Shop Kiosk" Style="{StaticResource Heading1}" Foreground="{DynamicResource Cream}"/>
                        <TextBlock Text="A friendly cafe interface for students" Style="{StaticResource SubHeading}" Foreground="{DynamicResource Cream}" Margin="0,4,0,0"/>
                    </StackPanel>

                </StackPanel>

                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,24,0" HorizontalAlignment="Right">
                    <StackPanel Orientation="Horizontal">
                        <ComboBox x:Name="ThemeSelector" Width="220" Height="34" Margin="0,0,10,0" Style="{StaticResource PrimaryComboBox}" SelectedValuePath="Content" ToolTip="Select visual theme">
                            <ComboBoxItem>Cafe</ComboBoxItem>
                            <ComboBoxItem>Rain</ComboBoxItem>
                            <ComboBoxItem>Sunset</ComboBoxItem>
                            <ComboBoxItem>Minimal</ComboBoxItem>
                        </ComboBox>
                        <Button x:Name="OpenStudyAssistant" Content="Study" Width="80" Height="34" Style="{StaticResource SecondaryButton}" ToolTip="Study Assistant (Ctrl+I)" Margin="0,0,8,0" />
                        <Button x:Name="OpenVisualSettings" Content="âš™" Width="36" Height="34" Style="{StaticResource SecondaryButton}" ToolTip="Visual Settings" />
                    </StackPanel>
                    <Button x:Name="ToggleCart" Content="Hide Cart" Width="100" Height="34" Style="{StaticResource SecondaryButton}" />
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- Main product list -->
        <views:ProductListView Grid.Row="1" Grid.Column="0" Margin="24,24,8,24" />

        <!-- Cart side panel with Pomodoro -->
        <StackPanel Grid.Row="1" Grid.Column="1" x:Name="CartPanel" Margin="8,24,24,24">
            <views:CartView DataContext="{Binding Cart}" />
            <views:PomodoroView DataContext="{Binding Pomodoro}" Margin="0,12,0,0" />
        </StackPanel>

        <!-- Toast host (non-blocking notifications) -->
        <views:ToastHost Grid.Row="0" Grid.Column="1" x:Name="ToastHost" />

        <!-- Spotlight overlay (covers content when SpotlightEnabled) -->
        <views:SpotlightOverlay x:Name="SpotlightOverlay" Grid.RowSpan="2" Grid.ColumnSpan="2" />

        <Grid.Resources>
            <DropShadowEffect x:Key="DropShadowEffect" Color="#000" BlurRadius="16" ShadowDepth="2" Opacity="0.18" />
        </Grid.Resources>
    </Grid>
</Window>